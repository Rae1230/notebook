---
sort: 2
---

# Calculus of Variations and Optimal Control 

## 1 Basic Concepts

### 1.1 Function and Functional

#### (1) Function

#### (2) Functional

&emsp;&emsp;变量$$ J $$是依赖于函数$$ f(x) $$的泛函，记作$$ J=J(f(x)) $$，如果对每个函数$$ f(x) $$，存在对应的$$ J $$值。

### 1.2 Increment

#### (1) Increment of a Function

**DEFINITION 2.1** 函数$$ f $$的增量，表示为$$ \Delta f $$，定义为

$$ \Delta f \triangleq f(t + \Delta t) - f(t)
\tag{2.1.4}
$$

从定义可以看出，$$ \Delta f $$与自变量$$ t $$和自变量的增量$$ \Delta t $$都相关，严格来说，函数的增量需要写成形如$$ \Delta f(t + \Delta t) $$的函数。

#### (2) Increment of a Functional

**DEFINITION 2.2** 泛函$$ J $$的增量，表示为$$ \Delta J $$，定义为

$$\begin{aligned}
    \boxed{\Delta J \triangleq J(x(t) + \delta x(t)) - J(x(t))}
\end{aligned}
\tag{2.1.7}
$$

其中，$$ \delta x(t) $$称为函数$$ x(t) $$的<font color="#33cc00">variation</font>。泛函的增量与函数$$ x(t) $$及其增量$$ \delta x(t) $$相关，严格来说，泛函的增量需要写成$$ \Delta J(x(t) , \delta x(t)) $$。

### 1.3 Differential and Variation

#### (1) Differential of a Function

&emsp;&emsp;定义函数$$ J $$在点$$ t^* $$处的增量为

$$ \Delta f \triangleq f(t^*+\Delta t) - f(t^*) 
\tag{2.1.10}
$$

将$$ f(t^*+\Delta t) $$在$$ t^* $$处Taylor展开，得到

$$ \Delta f
= f(t^*) 
+ \left( \frac{df}{dt} \right)_* \Delta t 
+ \frac{1}{2!} \left( \frac{d^2f}{dt^2} \right)_* (\Delta t)^2 
+ \cdots
- f(t^*) 
\tag{2.1.11}
$$

忽略$$ \Delta t $$中的高阶项，

$$ \Delta f
= \left( \frac{df}{dt} \right)_* \Delta t 
= \dot{f}(t^*) \Delta t 
= df
\tag{2.1.12}
$$

其中，$$ df $$称为$$ f $$在点$$ t^* $$处的<font color="#33cc00">differential</font>。$$ \dot{f}(t^*) $$是$$ f $$在点$$ t^* $$处的<font color="#33cc00">derivative</font>或slope。换言之，<font color="#3399ff">微分$ df $是增量$ \Delta t $的一阶近似</font>。增量、微分和导数的关系如图2.1所示。

<center>
    <figure>
        <img src="../../notebook\part3\images\fig2_1.JPG" width=400px>
        <figcaption>Figure 2.1 Increment, Differential and Dericative</figcaption>
    </figure>
</center>

#### (2) Variation of a Function

&emsp;&emsp;泛函的增量为

$$ \Delta J  
\triangleq J(x(t)+\delta x(t)) - J(x(t))
\tag{2.1.14}
$$

对$$ J(x(t)+\delta x(t)) $$进行Taylor展开，得到

$$ \begin{aligned}
\Delta J
& = J(x(t)) + \frac{\partial J}{\partial x} \delta x(t) 
  + \frac{1}{2!} \frac{\partial ^2 J}{\partial x^2} (\delta x(t))^2
  + \cdots - J(x(t)) \\
& = \frac{\partial J}{\partial x} \delta x(t) 
  + \frac{1}{2!} \frac{\partial ^2 J}{\partial x^2} (\delta x(t))^2
  + \cdots \\
& = \delta J + \delta^2 J + \cdots
\end{aligned}
\tag{2.1.15}
$$

其中，

$$ \delta J = \frac{\partial J}{\partial x} \delta x(t) 
\; \text{和} \; 
\delta^2 J = \frac{1}{2!} \frac{\partial ^2 J}{\partial x^2} (\delta x(t))^2
\tag{2.1.16}
$$

分别称为泛函$$ J $$的<font color="#33cc00">一阶变分</font>和<font color="#33cc00">二阶变分</font>。泛函$$ J $$的一阶变分$$ \delta J $$是增量$$ \delta J $$的线性（一阶近似）部分。泛函的增量与一阶变分的关系如图2.2所示。

<center>
    <figure>
        <img src="../../notebook\part3\images\fig2_2.JPG" width=400px>
        <figcaption>Figure 2.1 Increment and the First Variation</figcaption>
    </figure>
</center>


## 2 Optimum of a Function and a Functional

```note
变分在求泛函的最优值中所起的作用与微分在求函数的极值或最优值的所起的作用相同。
```

**DEFINITION 2.3** Optimum of a Function：如果存在一个正数$$ \epsilon $$，使得对于范围$$ D $$内的所有点都有$$ \vert t-t^* \vert \lt \epsilon $$，则称函数$$ f(t) $$在点$$ t^* $$处存在极值，$$ f(t) $$的增量符号相同。

&emsp;&emsp;函数取最值的必要条件为一阶微分消失，i.e.$$ df=0 $$。充分条件为：  
&emsp;&emsp;1.最小值：二阶微分为正，i.e.$$ d^2 f \gt 0 $$；  
&emsp;&emsp;2.最大值：二阶微分为负，i.e.$$ d^2 f \lt 0 $$。  
如果$$ d^2 f = 0 $$，那么该点为驻点（或拐点）。

**DEFINITION 2.3** <font color="#33cc00">Optimum of a Function</font>：如果存在一个正的$$ \epsilon $$，使得对于范围$$ \Omega $$内的所有函数$$ x $$都有$$ \vert x-x^{\*}\vert \lt \epsilon $$，则称泛函$$ J $$在$$ x^{\*} $$处取到relative optimum，$$ J $$的增量与之同符号。

&emsp;&emsp;换言之，如果

$$ \Delta J = J(x) - J(x^*) \ge 0 
\tag{2.2.3}
$$

那么$$ J(x^*) $$为极小值。如果

$$ \Delta J = J(x) - J(x^*) \le 0 
\tag{2.2.4}
$$

那么$$ J(x^{*}) $$为极大值。如果以上关系对于任意的$$ \epsilon $$都成立，那么$$ J(x^{*}) $$为全局最值。

**THEOREM 2.1** <font color="#33cc00">fundamental theorem of the calculus of variations</font>  
&emsp;&emsp;$$ x^{*}(t) $$为optimum的必要条件为：$$ J $$在$$ x^{*}(t) $$处的一阶变分为0，i.e.对于所有可能的$$ \delta x(t) $$值，有$$ \delta J(x^*(t),\delta x(t)) = 0 $$。在此基础上，充分条件：对于最小值，有二阶变分$$ \delta^2 J \gt 0 $$；对于最大值，有二阶变分$$ \delta^2 J \lt 0 $$。

## 3 The Basic Variational Problem

### 3.1 Fixed-End Time and Fixed-End State System

&emsp;&emsp;本节解决初始时间、状态和结束时间、状态都是确定的fixed-end time and fixed-end state问题。$$ x(t) $$是一阶导数连续的标量函数，向量情况也可以类似处理。问题是要找到最优函数$$ x^*(t) $$使得泛函

$$ J(x(t)) = \int_{t_0}^{t_f} V(x(t),\dot{x}(t),t) 
\tag{2.3.1}
$$

有相对最优。





$$  $$
<!-- 蓝 -->
<font color="#3399ff"></font>
<!-- 绿 -->
<font color="#33cc00"></font>